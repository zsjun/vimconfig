_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[57],{"1RQA":function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/poster",function(){return n("G8FO")}])},"FX+m":function(e,t,n){"use strict";var a=n("J3t6").default,r=n("nFQf").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=r(n("anXS")),o=r(n("Ntl0")),i=r(n("ctGQ")),c=a(n("q1tI")),u=r(n("4IMT")),s=n("4Blx");function f(e){return!(!e||!e.then)}var d=function(e){var t=c.useRef(!1),n=c.useRef(),a=(0,i.default)(!1),r=(0,o.default)(a,2),d=r[0],p=r[1],v=e.close,m=function(){null===v||void 0===v||v.apply(void 0,arguments)};c.useEffect((function(){var t;if(e.autoFocus){var a=n.current;t=setTimeout((function(){return a.focus()}))}return function(){t&&clearTimeout(t)}}),[]);var b=e.type,g=e.children,y=e.prefixCls,O=e.buttonProps;return c.createElement(u.default,(0,l.default)({},(0,s.convertLegacyProps)(b),{onClick:function(n){var a=e.actionFn;if(!t.current)if(t.current=!0,a){var r;if(e.emitEvent){if(r=a(n),e.quitOnNullishReturnValue&&!f(r))return t.current=!1,void m(n)}else if(a.length)r=a(v),t.current=!1;else if(!(r=a()))return void m();!function(e){f(e)&&(p(!0),e.then((function(){p(!1,!0),m.apply(void 0,arguments),t.current=!1}),(function(e){console.error(e),p(!1,!0),t.current=!1})))}(r)}else m()},loading:d,prefixCls:y},O,{ref:n}),g)};t.default=d},G8FO:function(e,t,n){"use strict";n.r(t);n("dc+4");var a=n("Btem"),r=n.n(a),l=(n("eOfH"),n("h0/l")),o=n.n(l),i=(n("MaXC"),n("4IMT")),c=n.n(i),u=(n("hr7U"),n("9xET")),s=n.n(u),f=(n("fv9D"),n("ZPTe")),d=n.n(f),p=n("wx14"),v=(n("8YFG"),n("ATwu")),m=n.n(v),b=(n("CXCZ"),n("hqwM")),g=n.n(b),y=(n("tL+A"),n("QpBz")),O=n.n(y),C=n("Ff2n"),h=n("ODXe"),x=(n("NcKm"),n("lbd2")),w=n.n(x),j=(n("mN36"),n("N9UN")),P=n.n(j),E=n("q1tI"),N=n.n(E),T=n("YFqc"),k=n.n(T),M=n("yCxO"),_=n.n(M),F=n("MLMA"),S=n("0Kvv"),I=n("ELla"),B=n("6HBy"),X=n("o0o1"),A=n.n(X),R=n("HaE+"),U=n("1OyB"),Q=n("vuIU"),q=n("pUN5"),J=function(){function e(){Object(U.a)(this,e)}return Object(Q.a)(e,null,[{key:"getPosters",value:function(){var e=Object(R.a)(A.a.mark((function e(t){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",q.a.get("/poster",{params:t}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"deletePoster",value:function(){var e=Object(R.a)(A.a.mark((function e(t){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",q.a.delete("/poster/".concat(t)));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),L=n("JMli"),V=n("NVXP"),G=n("M7TQ"),K=n("7LGd"),D=n("s1bl"),H=n("4rwI"),z=n("P0jS"),Y=n.n(z),Z=N.a.createElement,$=P.a.Meta,W=w.a.Paragraph,ee={position:"absolute",bottom:0,width:"100%",borderTop:"1px solid #e8e8e8",padding:"10px 16px",textAlign:"right",left:0,background:"#fff",borderRadius:"0 0 4px 4px"},te=function(e){var t=e.title,n=e.content;return Z("div",{className:Y.a.description},Z("p",null,t,":"),Z(W,{ellipsis:!0},n))},ne=[{label:"\u6587\u4ef6\u540d\u79f0",field:"name",msg:"\u8bf7\u8f93\u5165\u6587\u4ef6\u540d\u79f0"}],ae={gutter:16,xs:1,sm:2,md:4,lg:4,xl:4,xxl:6},re=null;t.default=function(){var e=Object(E.useRef)(),t=Object(B.a)(),n=Object(G.a)(!1),a=Object(h.a)(n,2),l=a[0],i=a[1],u=Object(E.useState)(null),f=u[0],v=u[1],b=Object(D.a)(J.getPosters),y=b.loading,x=b.data,w=b.refresh,j=Object(C.a)(b,["loading","data","refresh"]),T=Object(K.a)(J.deletePoster),M=Object(h.a)(T,2),X=M[0],A=M[1],R=Object(E.useMemo)((function(){return t&&t.oss}),[t]),U=Object(E.useCallback)((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return Array.isArray(e)||(e=[e]),function(){Promise.all(e.map((function(e){return X(e)}))).then((function(){O.a.success("\u64cd\u4f5c\u6210\u529f"),t&&t(),v(null),i(),w()}))}}),[X,i,w]),Q=Object(E.useCallback)((function(t){var n=function(t){return function(){v(t),i(),Promise.resolve().then((function(){re?re.update():re=new _.a(e.current,{inline:!1})}))}};return Z(g.a,{className:Y.a.imgs,grid:ae,dataSource:t,renderItem:function(e){return Z(g.a.Item,{key:e.id},Z(P.a,{hoverable:!0,cover:Z("div",{className:Y.a.preview},Z("img",{alt:e.name,src:e.imgUrl})),onClick:n(e)},Z($,{title:e.name,description:Z(N.a.Fragment,null,"\u4e0a\u4f20\u4e8e",Z(L.a,{date:e.createAt}))})))}})}),[i]);return Z(I.a,null,Z("div",{className:Y.a.wrapper},Z("div",{style:{marginBottom:24}},R?Z(V.a,{onOK:w}):Z(m.a,{message:Z("span",null,"\u7cfb\u7edf\u68c0\u6d4b\u5230",Z("strong",null,"\u963f\u91cc\u4e91OSS\u914d\u7f6e"),"\u672a\u5b8c\u5584\uff0c",Z(k.a,{href:"/setting?type=OSS%20\u8bbe\u7f6e"},Z("a",null,"\u70b9\u6211\u7acb\u5373\u5b8c\u5584"))),type:"warning"})),Z(H.a,Object(p.a)({loading:y,data:x,refresh:w},j,{searchFields:ne,customDataTable:Q})),Z(r.a,{width:640,placement:"right",title:"\u6587\u4ef6\u4fe1\u606f",closable:!0,onClose:i,visible:l},Z("div",{ref:e,className:Y.a.previewContainer},Z("img",{alt:f&&f.name,src:f&&f.imgUrl})),Z(s.a,null,Z(d.a,{span:24},Z(te,{title:"\u6587\u4ef6\u540d\u79f0",content:f&&f.name}))),Z(s.a,null,Z(d.a,{span:12},Z(te,{title:"\u5236\u4f5c\u9875\u9762",content:f&&f.pageUrl})),Z(d.a,{span:12},Z(te,{title:"\u6587\u4ef6\u5927\u5c0f",content:Object(F.a)(f&&f.size||0)}))),Z(s.a,null,Z(d.a,{span:24},Z(te,{title:"\u8bbf\u95ee\u94fe\u63a5",content:Z(N.a.Fragment,null,Z("div",{className:Y.a.urlContainer,onClick:function(){Object(S.a)(f&&f.imgUrl)}},f&&f.imgUrl),Z(c.a,{type:"link",onClick:function(){Object(S.a)(f&&f.imgUrl)}},"\u590d\u5236"))}))),Z("div",{style:ee},Z(c.a,{style:{marginRight:8},onClick:i},"\u5173\u95ed"),Z(o.a,{placement:"topRight",title:"\u786e\u8ba4\u5220\u9664\u8fd9\u4e2a\u6587\u4ef6\uff1f",onConfirm:U(f&&f.id),okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88"},Z(c.a,{danger:!0,loading:A},"\u5220\u9664"))))))}},M7TQ:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n("q1tI");function r(e){var t=Object(a.useState)(e),n=t[0],r=t[1];return[n,Object(a.useCallback)((function(){r((function(e){return!e}))}),[])]}},MLMA:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return r})),n.d(t,"d",(function(){return l})),n.d(t,"c",(function(){return o})),n.d(t,"e",(function(){return i}));var a=function(e,t){if(!t||!Array.isArray(e))return e;var n=Object.create(null),a=null;return e.forEach((function(e,r,l){null!==(a=t(e,r,l))&&void 0!==a&&(n[a]?n[a].push(e):n[a]=[e])})),n},r=function(e){return e<1024?e+" Byte":e<1048576?(e/1024).toFixed(2)+" KB":(e/1024/1024).toFixed(2)+" MB"};function l(e,t){return e||(e="/"),t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}var o=function(e){return e%2!==0},i=function(e){var t=e.scrollTop,n=e.offsetHeight,a=e.scrollHeight;e.scrollTo(0,t+(a-t-n))}},eOfH:function(e,t,n){"use strict";n("hcgS"),n("MaXC"),n("/xgg"),n("iteM")},"h0/l":function(e,t,n){"use strict";var a=n("nFQf").default,r=n("J3t6").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=a(n("anXS")),o=a(n("Ntl0")),i=a(n("sKbD")),c=a(n("TSYQ")),u=a(n("EO2L")),s=a(n("ftrU")),f=r(n("q1tI")),d=n("vgIT"),p=a(n("aOJk")),v=n("vCXI"),m=n("yvsJ"),b=void 0,g=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n},y=f.forwardRef((function(e,t){var n=f.useContext(d.ConfigContext).getPrefixCls,a=(0,u.default)(!1,{value:e.visible,defaultValue:e.defaultVisible}),r=(0,o.default)(a,2),i=r[0],y=r[1],O=function(t,n){var a;y(t,!0),null===(a=e.onVisibleChange)||void 0===a||a.call(e,t,n)},C=e.prefixCls,h=e.placement,x=e.children,w=e.overlayClassName,j=g(e,["prefixCls","placement","children","overlayClassName"]),P=n("popover",C),E=n("popconfirm",C),N=(0,c.default)(E,w);return f.createElement(p.default,(0,l.default)({},j,{prefixCls:P,placement:h,onVisibleChange:function(t){e.disabled||O(t)},visible:i,_overlay:f.createElement(m.Overlay,(0,l.default)({},e,{prefixCls:P,close:function(e){O(!1,e)},onConfirm:function(t){var n;return null===(n=e.onConfirm)||void 0===n?void 0:n.call(b,t)},onCancel:function(t){var n;O(!1,t),null===(n=e.onCancel)||void 0===n||n.call(b,t)}})),overlayClassName:N,ref:t}),(0,v.cloneElement)(x,{onKeyDown:function(e){var t,n;f.isValidElement(x)&&(null===(n=null===x||void 0===x?void 0:(t=x.props).onKeyDown)||void 0===n||n.call(t,e)),function(e){e.keyCode===s.default.ESC&&i&&O(!1,e)}(e)}}))}));y.defaultProps={placement:"top",trigger:"click",okType:"primary",icon:f.createElement(i.default,null),disabled:!1};var O=y;t.default=O},iteM:function(e,t,n){},yvsJ:function(e,t,n){"use strict";var a=n("J3t6").default,r=n("nFQf").default;Object.defineProperty(t,"__esModule",{value:!0}),t.Overlay=function(e){var t=e.prefixCls,n=e.okButtonProps,a=e.cancelButtonProps,r=e.title,v=e.cancelText,m=e.okText,b=e.okType,g=e.icon,y=e.showCancel,O=void 0===y||y,C=e.close,h=e.onConfirm,x=e.onCancel,w=o.useContext(p.ConfigContext).getPrefixCls;return o.createElement(s.default,{componentName:"Popconfirm",defaultLocale:f.default.Popconfirm},(function(e){return o.createElement("div",{className:"".concat(t,"-inner-content")},o.createElement("div",{className:"".concat(t,"-message")},g,o.createElement("div",{className:"".concat(t,"-message-title")},(0,d.getRenderPropValue)(r))),o.createElement("div",{className:"".concat(t,"-buttons")},O&&o.createElement(i.default,(0,l.default)({onClick:x,size:"small"},a),v||e.cancelText),o.createElement(u.default,{buttonProps:(0,l.default)((0,l.default)({size:"small"},(0,c.convertLegacyProps)(b)),n),actionFn:h,close:C,prefixCls:w("btn"),quitOnNullishReturnValue:!0,emitEvent:!0},m||e.okText)))}))};var l=r(n("anXS")),o=a(n("q1tI")),i=r(n("4IMT")),c=n("4Blx"),u=r(n("FX+m")),s=r(n("GG9M")),f=r(n("PE/4")),d=n("yBST"),p=n("vgIT")}},[["1RQA",2,3,0,4,5,6,7,8,9,10,11,12,13,14,17,15,16,19,20,21,23,30,1]]]);