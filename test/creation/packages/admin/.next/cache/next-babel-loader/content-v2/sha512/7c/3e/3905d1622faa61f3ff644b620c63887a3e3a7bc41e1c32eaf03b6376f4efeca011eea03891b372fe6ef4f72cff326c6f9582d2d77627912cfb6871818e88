{"ast":null,"code":"import \"antd/lib/drawer/style\";\nimport _Drawer from \"antd/lib/drawer\";\nimport \"antd/lib/button/style\";\nimport _Button from \"antd/lib/button\";\nimport \"antd/lib/select/style\";\nimport _Select from \"antd/lib/select\";\nimport \"antd/lib/switch/style\";\nimport _Switch from \"antd/lib/switch\";\nimport \"antd/lib/input/style\";\nimport _Input from \"antd/lib/input\";\nimport _defineProperty from \"/Users/zsj/work/vimconfig/test/creation/packages/admin/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useState, useEffect, useReducer } from 'react';\nimport { FileSelectDrawer } from '@/components/FileSelectDrawer';\nimport { CategoryProvider } from '@/providers/category';\nimport { TagProvider } from '@/providers/tag';\nimport style from './index.module.scss';\n\nvar FormItem = function FormItem(_ref) {\n  var label = _ref.label,\n      content = _ref.content;\n  return __jsx(\"div\", {\n    className: style.formItem\n  }, __jsx(\"span\", null, label), __jsx(\"div\", null, content));\n};\n\nvar initialArticleAttrs = {\n  summary: null,\n  // 摘要\n  password: null,\n  // 密码\n  totalAmount: null,\n  //支付金额\n  isCommentable: true,\n  // 评论\n  isRecommended: true,\n  // 推荐到首页\n  category: null,\n  // 分类\n  tags: [],\n  // 标签\n  cover: null // 封面\n\n};\n\nfunction reducer() {\n  var state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : initialArticleAttrs;\n  var action = arguments.length > 1 ? arguments[1] : undefined;\n  var payload = action.payload;\n\n  switch (action.type) {\n    case 'summary':\n      return _objectSpread(_objectSpread({}, state), {}, {\n        summary: payload\n      });\n\n    case 'password':\n      return _objectSpread(_objectSpread({}, state), {}, {\n        password: payload\n      });\n\n    case 'totalAmount':\n      return _objectSpread(_objectSpread({}, state), {}, {\n        totalAmount: payload\n      });\n\n    case 'isCommentable':\n      return _objectSpread(_objectSpread({}, state), {}, {\n        isCommentable: payload\n      });\n\n    case 'isRecommended':\n      return _objectSpread(_objectSpread({}, state), {}, {\n        isRecommended: payload\n      });\n\n    case 'category':\n      return _objectSpread(_objectSpread({}, state), {}, {\n        category: payload\n      });\n\n    case 'tags':\n      return _objectSpread(_objectSpread({}, state), {}, {\n        tags: payload\n      });\n\n    case 'cover':\n      return _objectSpread(_objectSpread({}, state), {}, {\n        cover: payload\n      });\n\n    default:\n      return state;\n  }\n}\n\nexport var ArticleSettingDrawer = function ArticleSettingDrawer(_ref2) {\n  var article = _ref2.article,\n      visible = _ref2.visible,\n      onClose = _ref2.onClose,\n      onChange = _ref2.onChange;\n\n  var _useState = useState(false),\n      fileVisible = _useState[0],\n      setFileVisible = _useState[1];\n\n  var _useReducer = useReducer(reducer, article),\n      attrs = _useReducer[0],\n      dispatch = _useReducer[1];\n\n  var _useState2 = useState([]),\n      categorys = _useState2[0],\n      setCategorys = _useState2[1];\n\n  var _useState3 = useState([]),\n      tags = _useState3[0],\n      setTags = _useState3[1];\n\n  useEffect(function () {\n    CategoryProvider.getCategory().then(function (res) {\n      return setCategorys(res);\n    });\n    TagProvider.getTags().then(function (tags) {\n      return setTags(tags);\n    });\n  }, []);\n\n  var ok = function ok() {\n    onChange(_objectSpread(_objectSpread({}, attrs), {}, {\n      tags: (attrs.tags || []).join(',')\n    }));\n  };\n\n  return __jsx(_Drawer, {\n    width: 480,\n    placement: \"right\",\n    title: '文章设置',\n    closable: true,\n    onClose: onClose,\n    visible: visible\n  }, __jsx(FormItem, {\n    label: \"\\u6587\\u7AE0\\u6458\\u8981\",\n    content: __jsx(_Input.TextArea, {\n      className: style.formItem,\n      placeholder: \"\\u8BF7\\u8F93\\u5165\\u6587\\u7AE0\\u6458\\u8981\",\n      autoSize: {\n        minRows: 6,\n        maxRows: 8\n      },\n      value: attrs.summary,\n      onChange: function onChange(e) {\n        dispatch({\n          type: 'summary',\n          payload: e.target.value\n        });\n      }\n    })\n  }), __jsx(FormItem, {\n    label: \"\\u8BBF\\u95EE\\u5BC6\\u7801\",\n    content: __jsx(_Input.Password, {\n      placeholder: \"\\u8F93\\u5165\\u540E\\u67E5\\u770B\\u9700\\u8981\\u5BC6\\u7801\",\n      value: attrs.password,\n      onChange: function onChange(e) {\n        dispatch({\n          type: 'password',\n          payload: e.target.value\n        });\n      }\n    })\n  }), __jsx(FormItem, {\n    label: \"\\u4ED8\\u8D39\\u67E5\\u770B\",\n    content: __jsx(_Input.Password, {\n      placeholder: \"\\u8F93\\u5165\\u540E\\u9700\\u8981\\u652F\\u4ED8\\u7684\\u8D39\\u7528\",\n      value: attrs.totalAmount,\n      onChange: function onChange(e) {\n        dispatch({\n          type: 'totalAmount',\n          payload: e.target.value\n        });\n      }\n    })\n  }), __jsx(FormItem, {\n    label: \"\\u5F00\\u542F\\u8BC4\\u8BBA\",\n    content: __jsx(_Switch, {\n      checked: attrs.isCommentable,\n      onChange: function onChange(val) {\n        dispatch({\n          type: 'isCommentable',\n          payload: val\n        });\n      }\n    })\n  }), __jsx(FormItem, {\n    label: \"\\u9996\\u9875\\u63A8\\u8350\",\n    content: __jsx(_Switch, {\n      checked: attrs.isRecommended,\n      onChange: function onChange(val) {\n        dispatch({\n          type: 'isRecommended',\n          payload: val\n        });\n      }\n    })\n  }), __jsx(FormItem, {\n    label: \"\\u9009\\u62E9\\u5206\\u7C7B\",\n    content: __jsx(_Select, {\n      value: attrs.category && attrs.category.id || attrs.category,\n      onChange: function onChange(id) {\n        dispatch({\n          type: 'category',\n          payload: id\n        });\n      },\n      style: {\n        width: '100%'\n      }\n    }, categorys.map(function (t) {\n      return __jsx(_Select.Option, {\n        key: t.id,\n        value: t.id\n      }, t.label);\n    }))\n  }), __jsx(FormItem, {\n    label: \"\\u9009\\u62E9\\u6807\\u7B7E\",\n    content: __jsx(_Select, {\n      style: {\n        width: '100%'\n      },\n      mode: \"tags\",\n      value: (attrs.tags || []).map(function (t) {\n        return t.id || t;\n      }),\n      onChange: function onChange(tags) {\n        dispatch({\n          type: 'tags',\n          payload: tags\n        });\n      }\n    }, tags.map(function (tag) {\n      return __jsx(_Select.Option, {\n        key: tag.id,\n        value: tag.id\n      }, tag.label);\n    }))\n  }), __jsx(FormItem, {\n    label: \"\\u6587\\u7AE0\\u5C01\\u9762\",\n    content: __jsx(\"div\", {\n      className: style.cover\n    }, __jsx(\"div\", {\n      onClick: function onClick() {\n        return setFileVisible(true);\n      },\n      className: style.preview\n    }, __jsx(\"img\", {\n      src: attrs.cover,\n      alt: \"\\u9884\\u89C8\\u56FE\"\n    })), __jsx(_Input, {\n      placeholder: \"\\u6216\\u8F93\\u5165\\u5916\\u90E8\\u94FE\\u63A5\",\n      value: attrs.cover,\n      onChange: function onChange(e) {\n        dispatch({\n          type: 'cover',\n          payload: e.target.value\n        });\n      }\n    }), __jsx(_Button, {\n      onClick: function onClick() {\n        dispatch({\n          type: 'cover',\n          payload: null\n        });\n      }\n    }, \"\\u79FB\\u9664\"))\n  }), __jsx(FileSelectDrawer, {\n    closeAfterClick: true,\n    visible: fileVisible,\n    onClose: function onClose() {\n      return setFileVisible(false);\n    },\n    onChange: function onChange(url) {\n      dispatch({\n        type: 'cover',\n        payload: url\n      });\n    }\n  }), __jsx(\"div\", {\n    style: {\n      position: 'absolute',\n      bottom: 0,\n      width: '100%',\n      borderTop: '1px solid #e8e8e8',\n      padding: '10px 16px',\n      textAlign: 'right',\n      left: 0,\n      background: '#fff',\n      borderRadius: '0 0 4px 4px'\n    }\n  }, __jsx(_Button, {\n    type: \"primary\",\n    onClick: ok\n  }, \"\\u786E\\u8BA4\")));\n};","map":null,"metadata":{},"sourceType":"module"}