{"ast":null,"code":"import \"antd/lib/row/style\";\nimport _Row from \"antd/lib/row\";\nimport \"antd/lib/col/style\";\nimport _Col from \"antd/lib/col\";\nimport \"antd/lib/card/style\";\nimport _Card from \"antd/lib/card\";\nimport \"antd/lib/popconfirm/style\";\nimport _Popconfirm from \"antd/lib/popconfirm\";\nimport \"antd/lib/button/style\";\nimport _Button from \"antd/lib/button\";\nimport \"antd/lib/input/style\";\nimport _Input from \"antd/lib/input\";\nimport \"antd/lib/message/style\";\nimport _message from \"antd/lib/message\";\nvar __jsx = React.createElement;\nimport React, { useState, useCallback, useMemo } from 'react';\nimport { Form } from '@ant-design/compatible';\nimport cls from 'classnames';\nimport { AdminLayout } from '@/layout/AdminLayout';\nimport { CategoryProvider } from '@/providers/category';\nimport style from './index.module.scss';\n\nconst Page = ({\n  data: defaultData = []\n}) => {\n  const {\n    0: data,\n    1: setData\n  } = useState(defaultData);\n  const {\n    0: mode,\n    1: setMode\n  } = useState('create');\n  const {\n    0: current,\n    1: setCurrent\n  } = useState(null);\n  const {\n    0: label,\n    1: setLabel\n  } = useState(null);\n  const {\n    0: value,\n    1: setValue\n  } = useState(null);\n  const isCreateMode = useMemo(() => mode === 'create', [mode]);\n  const getData = useCallback(() => {\n    CategoryProvider.getCategory().then(res => {\n      setData(res);\n    });\n  }, []);\n  const reset = useCallback(() => {\n    setMode('create');\n    setCurrent(null);\n    setLabel(null);\n    setValue(null);\n  }, []);\n  const addTag = useCallback(data => {\n    if (!data || !data.label) {\n      return;\n    }\n\n    CategoryProvider.add(data).then(() => {\n      _message.success('添加分类成功');\n\n      reset();\n      getData();\n    });\n  }, [reset, getData]);\n  const updateTag = useCallback((id, data) => {\n    if (!data || !data.label) {\n      return;\n    }\n\n    CategoryProvider.update(id, data).then(() => {\n      _message.success('更新分类成功');\n\n      reset();\n      getData();\n    });\n  }, [reset, getData]);\n  const deleteTag = useCallback(id => {\n    CategoryProvider.delete(id).then(() => {\n      _message.success('删除分类成功');\n\n      reset();\n      getData();\n    });\n  }, [reset, getData]);\n  return __jsx(AdminLayout, null, __jsx(_Row, {\n    gutter: 16,\n    className: style.wrapper\n  }, __jsx(_Col, {\n    xs: 24,\n    sm: 24,\n    md: 9\n  }, __jsx(_Card, {\n    title: isCreateMode ? '添加分类' : '管理分类',\n    bordered: true\n  }, __jsx(Form.Item, null, __jsx(_Input, {\n    value: label,\n    placeholder: '输入分类名称',\n    onChange: e => {\n      setLabel(e.target.value);\n    }\n  })), __jsx(Form.Item, null, __jsx(_Input, {\n    value: value,\n    placeholder: '输入分类值（请输入英文，作为路由使用）',\n    onChange: e => {\n      setValue(e.target.value);\n    }\n  })), __jsx(\"div\", {\n    className: cls(style.btns, isCreateMode ? false : style.isEdit)\n  }, isCreateMode ? __jsx(_Button, {\n    type: \"primary\",\n    onClick: () => addTag({\n      label,\n      value\n    })\n  }, \"\\u4FDD\\u5B58\") : __jsx(React.Fragment, null, __jsx(_Button.Group, null, __jsx(_Button, {\n    type: \"primary\",\n    onClick: () => updateTag(current.id, {\n      label,\n      value\n    })\n  }, \"\\u66F4\\u65B0\"), __jsx(_Button, {\n    type: \"dashed\",\n    onClick: () => reset()\n  }, \"\\u8FD4\\u56DE\\u6DFB\\u52A0\")), __jsx(_Popconfirm, {\n    title: \"\\u786E\\u8BA4\\u5220\\u9664\\u8FD9\\u4E2A\\u5206\\u7C7B\\uFF1F\",\n    onConfirm: () => deleteTag(current.id),\n    okText: \"\\u786E\\u8BA4\",\n    cancelText: \"\\u53D6\\u6D88\"\n  }, __jsx(_Button, {\n    danger: true\n  }, \"\\u5220\\u9664\")))))), __jsx(_Col, {\n    xs: 24,\n    sm: 24,\n    md: 15\n  }, __jsx(_Card, {\n    title: \"\\u6240\\u6709\\u5206\\u7C7B\",\n    bordered: true\n  }, __jsx(\"ul\", {\n    className: style.list\n  }, data.map(d => __jsx(\"li\", {\n    key: d.id,\n    className: cls(style.item),\n    onClick: () => {\n      setMode('edit');\n      setCurrent(d);\n      setLabel(d.label);\n      setValue(d.value);\n    }\n  }, __jsx(\"a\", {\n    key: d.id,\n    className: style.tag\n  }, __jsx(\"span\", null, d.label)))))))));\n};\n\nPage.getInitialProps = async () => {\n  const data = await CategoryProvider.getCategory();\n  return {\n    data\n  };\n};\n\nexport default Page;","map":null,"metadata":{},"sourceType":"module"}