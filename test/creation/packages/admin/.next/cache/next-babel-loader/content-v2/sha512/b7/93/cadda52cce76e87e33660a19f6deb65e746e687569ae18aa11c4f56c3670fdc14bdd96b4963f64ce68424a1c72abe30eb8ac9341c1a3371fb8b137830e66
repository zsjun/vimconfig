{"ast":null,"code":"import \"antd/lib/list/style\";\nimport _List from \"antd/lib/list\";\nimport \"antd/lib/row/style\";\nimport _Row from \"antd/lib/row\";\nimport \"antd/lib/col/style\";\nimport _Col from \"antd/lib/col\";\nimport \"antd/lib/card/style\";\nimport _Card from \"antd/lib/card\";\nimport \"antd/lib/alert/style\";\nimport _Alert from \"antd/lib/alert\";\nimport \"antd/lib/typography/style\";\nimport _Typography from \"antd/lib/typography\";\nvar __jsx = React.createElement;\nimport React, { useCallback, useState } from 'react';\nimport Link from 'next/link';\nimport { useSetting } from '@/hooks/useSetting';\nimport { useUser } from '@/hooks/useUser';\nimport { AdminLayout } from '@/layout/AdminLayout';\nimport { ArticleProvider } from '@/providers/article';\nimport { CommentProvider } from '@/providers/comment';\nimport { CommentArticle } from '@/components/comment/CommentArticle';\nimport { CommentStatus } from '@/components/comment/CommentStatus';\nimport { CommentAction } from '@/components/comment/CommentAction';\nimport { CommentContent } from '@/components/comment/CommentContent';\nimport style from './index.module.scss';\nimport EchartView from '@/components/EchartView';\nconst {\n  Title,\n  Paragraph\n} = _Typography;\nconst actions = [{\n  name: '文章管理',\n  url: '/article'\n}, {\n  name: '评论管理',\n  url: '/comment'\n}, {\n  name: '文件管理',\n  url: '/file'\n}, {\n  name: '用户管理',\n  url: '/user'\n}, {\n  name: '访问管理',\n  url: '/view'\n}, {\n  name: '系统设置',\n  url: '/setting'\n}];\nconst pageSize = 6;\n\nconst Home = ({\n  articles = [],\n  comments: defaultComments = []\n}) => {\n  const setting = useSetting();\n  const user = useUser();\n  const {\n    0: comments,\n    1: setComments\n  } = useState(defaultComments);\n  const getComments = useCallback(() => {\n    return CommentProvider.getComments({\n      page: 1,\n      pageSize\n    }).then(res => {\n      setComments(res[0]);\n      return res;\n    });\n  }, []);\n  return __jsx(AdminLayout, {\n    headerAppender: __jsx(_Typography, null, __jsx(Title, null, \"\\u60A8\\u597D\\uFF0C\", user.name), __jsx(Paragraph, null, \"\\u60A8\\u7684\\u89D2\\u8272\\uFF1A\", user.role === 'admin' ? '管理员' : '访客'))\n  }, !setting || !setting.systemUrl ? __jsx(\"div\", {\n    style: {\n      marginBottom: 24\n    }\n  }, __jsx(_Alert, {\n    message: __jsx(\"span\", null, \"\\u7CFB\\u7EDF\\u68C0\\u6D4B\\u5230\", __jsx(\"strong\", null, \"\\u7CFB\\u7EDF\\u914D\\u7F6E\"), \"\\u672A\\u5B8C\\u5584\\uFF0C\", __jsx(Link, {\n      href: \"/setting?type=\\u7CFB\\u7EDF\\u8BBE\\u7F6E\"\n    }, __jsx(\"a\", null, \"\\u70B9\\u6211\\u7ACB\\u5373\\u5B8C\\u5584\"))),\n    type: \"warning\"\n  })) : null, __jsx(_Card, {\n    title: \"\\u9762\\u677F\\u5BFC\\u822A\",\n    bordered: false,\n    bodyStyle: {\n      padding: 0\n    }\n  }, __jsx(EchartView, {\n    option: {\n      legend: {\n        data: ['评论数', '访问量']\n      },\n      title: {\n        text: '每周用户访问指标',\n        padding: 25\n      },\n      xAxis: {\n        type: 'category',\n        data: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun']\n      },\n      yAxis: {\n        type: 'value'\n      },\n      series: [{\n        name: '评论数',\n        data: [120, 200, 150, 80, 70, 110, 130],\n        type: 'bar'\n      }, {\n        name: '访问量',\n        type: 'line',\n        data: [360, 289, 352, 120, 96, 130, 166]\n      }]\n    }\n  })), __jsx(_Card, {\n    title: \"\\u5FEB\\u901F\\u5BFC\\u822A\",\n    bordered: false,\n    style: {\n      marginTop: 24\n    },\n    bodyStyle: {\n      padding: 0\n    }\n  }, __jsx(_Row, null, actions.map(action => {\n    return __jsx(_Col, {\n      key: action.url,\n      span: 4,\n      style: {\n        padding: '2rem 1rem',\n        textAlign: 'center'\n      }\n    }, __jsx(Link, {\n      href: action.url\n    }, __jsx(\"a\", {\n      className: style.recentArticleItem\n    }, __jsx(\"span\", null, action.name))));\n  }))), __jsx(_Card, {\n    title: \"\\u6700\\u65B0\\u6587\\u7AE0\",\n    bordered: false,\n    style: {\n      marginTop: 24\n    },\n    bodyStyle: {\n      padding: 0\n    },\n    extra: __jsx(Link, {\n      href: \"/article\"\n    }, __jsx(\"a\", null, __jsx(\"span\", null, \"\\u5168\\u90E8\\u6587\\u7AE0\")))\n  }, articles.map(article => {\n    return __jsx(_Card.Grid, {\n      key: article.id,\n      style: {\n        width: '33.3%',\n        textAlign: 'center'\n      },\n      hoverable: true\n    }, __jsx(Link, {\n      href: `/article/editor/[id]`,\n      as: `/article/editor/` + article.id\n    }, __jsx(\"a\", {\n      className: style.recentArticleItem\n    }, __jsx(\"img\", {\n      width: 120,\n      alt: \"\\u6587\\u7AE0\\u5C01\\u9762\",\n      src: article.cover\n    }), __jsx(\"p\", {\n      className: style.title\n    }, article.title))));\n  })), __jsx(_Card, {\n    title: \"\\u6700\\u65B0\\u8BC4\\u8BBA\",\n    style: {\n      marginTop: 24\n    },\n    bordered: false,\n    extra: __jsx(Link, {\n      href: \"/comment\"\n    }, __jsx(\"a\", null, __jsx(\"span\", null, \"\\u5168\\u90E8\\u8BC4\\u8BBA\")))\n  }, __jsx(_List, {\n    dataSource: comments,\n    renderItem: comment => __jsx(_List.Item, {\n      key: comment.id,\n      actions: [__jsx(CommentAction, {\n        key: \"action\",\n        comment: comment,\n        refresh: getComments\n      })]\n    }, __jsx(\"span\", null, comment.name), \" \\u5728 \", __jsx(CommentArticle, {\n      comment: comment\n    }), \" \\u8BC4\\u8BBA\", ' ', __jsx(CommentContent, {\n      comment: comment\n    }), __jsx(CommentStatus, {\n      comment: comment\n    }))\n  })));\n};\n\nHome.getInitialProps = async () => {\n  const [articles, comments] = await Promise.all([ArticleProvider.getArticles({\n    page: 1,\n    pageSize\n  }), CommentProvider.getComments({\n    page: 1,\n    pageSize\n  })]);\n  return {\n    articles: articles[0],\n    comments: comments[0]\n  };\n};\n\nexport default Home;","map":null,"metadata":{},"sourceType":"module"}