{"ast":null,"code":"import _regeneratorRuntime from \"/Users/zsj/work/vimconfig/test/creation/packages/admin/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/zsj/work/vimconfig/test/creation/packages/admin/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport \"antd/lib/row/style\";\nimport _Row from \"antd/lib/row\";\nimport \"antd/lib/col/style\";\nimport _Col from \"antd/lib/col\";\nimport \"antd/lib/card/style\";\nimport _Card from \"antd/lib/card\";\nimport \"antd/lib/popconfirm/style\";\nimport _Popconfirm from \"antd/lib/popconfirm\";\nimport \"antd/lib/button/style\";\nimport _Button from \"antd/lib/button\";\nimport \"antd/lib/input/style\";\nimport _Input from \"antd/lib/input\";\nimport \"antd/lib/message/style\";\nimport _message from \"antd/lib/message\";\nvar __jsx = React.createElement;\nimport React, { useState, useCallback, useMemo } from 'react';\nimport { Form } from '@ant-design/compatible';\nimport cls from 'classnames';\nimport { AdminLayout } from '@/layout/AdminLayout';\nimport { CategoryProvider } from '@/providers/category';\nimport style from './index.module.scss';\n\nvar Page = function Page(_ref) {\n  var _ref$data = _ref.data,\n      defaultData = _ref$data === void 0 ? [] : _ref$data;\n\n  var _useState = useState(defaultData),\n      data = _useState[0],\n      setData = _useState[1];\n\n  var _useState2 = useState('create'),\n      mode = _useState2[0],\n      setMode = _useState2[1];\n\n  var _useState3 = useState(null),\n      current = _useState3[0],\n      setCurrent = _useState3[1];\n\n  var _useState4 = useState(null),\n      label = _useState4[0],\n      setLabel = _useState4[1];\n\n  var _useState5 = useState(null),\n      value = _useState5[0],\n      setValue = _useState5[1];\n\n  var isCreateMode = useMemo(function () {\n    return mode === 'create';\n  }, [mode]);\n  var getData = useCallback(function () {\n    CategoryProvider.getCategory().then(function (res) {\n      setData(res);\n    });\n  }, []);\n  var reset = useCallback(function () {\n    setMode('create');\n    setCurrent(null);\n    setLabel(null);\n    setValue(null);\n  }, []);\n  var addTag = useCallback(function (data) {\n    if (!data || !data.label) {\n      return;\n    }\n\n    CategoryProvider.add(data).then(function () {\n      _message.success('添加分类成功');\n\n      reset();\n      getData();\n    });\n  }, [reset, getData]);\n  var updateTag = useCallback(function (id, data) {\n    if (!data || !data.label) {\n      return;\n    }\n\n    CategoryProvider.update(id, data).then(function () {\n      _message.success('更新分类成功');\n\n      reset();\n      getData();\n    });\n  }, [reset, getData]);\n  var deleteTag = useCallback(function (id) {\n    CategoryProvider[\"delete\"](id).then(function () {\n      _message.success('删除分类成功');\n\n      reset();\n      getData();\n    });\n  }, [reset, getData]);\n  return __jsx(AdminLayout, null, __jsx(_Row, {\n    gutter: 16,\n    className: style.wrapper\n  }, __jsx(_Col, {\n    xs: 24,\n    sm: 24,\n    md: 9\n  }, __jsx(_Card, {\n    title: isCreateMode ? '添加分类' : '管理分类',\n    bordered: true\n  }, __jsx(Form.Item, null, __jsx(_Input, {\n    value: label,\n    placeholder: '输入分类名称',\n    onChange: function onChange(e) {\n      setLabel(e.target.value);\n    }\n  })), __jsx(Form.Item, null, __jsx(_Input, {\n    value: value,\n    placeholder: '输入分类值（请输入英文，作为路由使用）',\n    onChange: function onChange(e) {\n      setValue(e.target.value);\n    }\n  })), __jsx(\"div\", {\n    className: cls(style.btns, isCreateMode ? false : style.isEdit)\n  }, isCreateMode ? __jsx(_Button, {\n    type: \"primary\",\n    onClick: function onClick() {\n      return addTag({\n        label: label,\n        value: value\n      });\n    }\n  }, \"\\u4FDD\\u5B58\") : __jsx(React.Fragment, null, __jsx(_Button.Group, null, __jsx(_Button, {\n    type: \"primary\",\n    onClick: function onClick() {\n      return updateTag(current.id, {\n        label: label,\n        value: value\n      });\n    }\n  }, \"\\u66F4\\u65B0\"), __jsx(_Button, {\n    type: \"dashed\",\n    onClick: function onClick() {\n      return reset();\n    }\n  }, \"\\u8FD4\\u56DE\\u6DFB\\u52A0\")), __jsx(_Popconfirm, {\n    title: \"\\u786E\\u8BA4\\u5220\\u9664\\u8FD9\\u4E2A\\u5206\\u7C7B\\uFF1F\",\n    onConfirm: function onConfirm() {\n      return deleteTag(current.id);\n    },\n    okText: \"\\u786E\\u8BA4\",\n    cancelText: \"\\u53D6\\u6D88\"\n  }, __jsx(_Button, {\n    danger: true\n  }, \"\\u5220\\u9664\")))))), __jsx(_Col, {\n    xs: 24,\n    sm: 24,\n    md: 15\n  }, __jsx(_Card, {\n    title: \"\\u6240\\u6709\\u5206\\u7C7B\",\n    bordered: true\n  }, __jsx(\"ul\", {\n    className: style.list\n  }, data.map(function (d) {\n    return __jsx(\"li\", {\n      key: d.id,\n      className: cls(style.item),\n      onClick: function onClick() {\n        setMode('edit');\n        setCurrent(d);\n        setLabel(d.label);\n        setValue(d.value);\n      }\n    }, __jsx(\"a\", {\n      key: d.id,\n      className: style.tag\n    }, __jsx(\"span\", null, d.label)));\n  }))))));\n};\n\nPage.getInitialProps = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n  var data;\n  return _regeneratorRuntime.wrap(function _callee$(_context) {\n    while (1) {\n      switch (_context.prev = _context.next) {\n        case 0:\n          _context.next = 2;\n          return CategoryProvider.getCategory();\n\n        case 2:\n          data = _context.sent;\n          return _context.abrupt(\"return\", {\n            data: data\n          });\n\n        case 4:\n        case \"end\":\n          return _context.stop();\n      }\n    }\n  }, _callee);\n}));\nexport default Page;","map":null,"metadata":{},"sourceType":"module"}