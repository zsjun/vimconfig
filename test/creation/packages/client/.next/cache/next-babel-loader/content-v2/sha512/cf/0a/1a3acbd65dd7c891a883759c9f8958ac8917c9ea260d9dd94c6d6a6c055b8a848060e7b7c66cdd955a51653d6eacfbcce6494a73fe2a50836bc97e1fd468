{"ast":null,"code":"var __jsx = React.createElement;\nimport React, { useContext } from 'react';\nimport Link from 'next/link';\nimport { useTranslations } from 'next-intl';\nimport { ArticleProvider } from '@/providers/article';\nimport { GlobalContext } from '@/context/global';\nimport { DoubleColumnLayout } from '@/layout/DoubleColumnLayout';\nimport { ListTrail } from '@/components/Animation/Trail';\nimport { LocaleTime } from '@/components/LocaleTime';\nimport { ArticleRecommend } from '@/components/ArticleRecommend';\nimport { Categories } from '@components/Categories';\nimport style from './index.module.scss';\n\nconst ArchiveItem = ({\n  month,\n  articles = []\n}) => {\n  return __jsx(\"div\", {\n    className: style.item\n  }, __jsx(\"h3\", null, month), __jsx(\"ul\", null, __jsx(ListTrail, {\n    length: articles.length,\n    options: {\n      opacity: 1,\n      height: 48,\n      x: 0,\n      from: {\n        opacity: 0,\n        height: 0,\n        x: -20\n      }\n    },\n    renderItem: index => {\n      const article = articles[index];\n      return __jsx(Link, {\n        href: `/article/[id]`,\n        as: `/article/${article.id}`,\n        scroll: false\n      }, __jsx(\"a\", null, __jsx(\"span\", {\n        className: style.meta\n      }, __jsx(LocaleTime, {\n        date: article.publishAt,\n        format: 'MM-dd'\n      })), __jsx(\"span\", {\n        className: style.title\n      }, article.title)));\n    }\n  })));\n};\n\nconst resolveArticlesCount = articles => {\n  const years = Object.keys(articles);\n  return years.reduce((a, year) => {\n    const months = Object.keys(articles[year]);\n    a += months.reduce((b, month) => b += articles[year][month].length, 0);\n    return a;\n  }, 0);\n};\n\nconst Archives = ({\n  articles\n}) => {\n  const {\n    categories\n  } = useContext(GlobalContext);\n  const t = useTranslations();\n  return __jsx(DoubleColumnLayout, {\n    leftNode: __jsx(\"div\", {\n      className: style.content\n    }, __jsx(\"div\", {\n      className: style.summary\n    }, __jsx(\"p\", null, __jsx(\"span\", null, t('archives'))), __jsx(\"p\", null, t('total'), \" \", __jsx(\"span\", null, resolveArticlesCount(articles)), \" \", t('piece'))), Object.keys(articles).sort((a, b) => +b - +a).map(year => {\n      return __jsx(\"div\", {\n        className: style.list,\n        key: year\n      }, __jsx(\"h2\", null, year), Object.keys(articles[year]).map(month => {\n        return __jsx(ArchiveItem, {\n          key: year + '-' + month,\n          month: month,\n          articles: articles[year][month]\n        });\n      }));\n    })),\n    rightNode: __jsx(\"div\", {\n      className: \"sticky\"\n    }, __jsx(ArticleRecommend, {\n      mode: \"inline\"\n    }), __jsx(Categories, {\n      categories: categories\n    }))\n  });\n}; // 服务端预取数据\n\n\nArchives.getInitialProps = async () => {\n  const articles = await ArticleProvider.getArchives();\n  return {\n    articles\n  };\n};\n\nexport default Archives;","map":null,"metadata":{},"sourceType":"module"}