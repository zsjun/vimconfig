{"ast":null,"code":"import RSS from '@/rss/index.js';\nimport { ArticleProvider } from '@/providers/article';\nimport { SettingProvider } from '@/providers/setting';\nimport { CategoryProvider } from '@/providers/category';\n\nconst url = require('url');\n\nconst Rss = () => {\n  return null;\n}; // 服务端预取数据\n\n\nRss.getInitialProps = async ctx => {\n  const {\n    res\n  } = ctx;\n  res.setHeader('Content-Type', 'text/xml');\n  const [[articles], setting, categories] = await Promise.all([ArticleProvider.getArticles({\n    page: 1,\n    pageSize: 99999,\n    status: 'publish'\n  }), SettingProvider.getSetting(), CategoryProvider.getCategory({\n    articleStatus: 'publish'\n  })]);\n  const feed = new RSS({\n    title: setting.systemTitle,\n    description: setting.seoDesc,\n    feed_url: url.resolve(setting.systemUrl, 'rss'),\n    site_url: setting.systemUrl,\n    author: 'https://github.com/fantasticit',\n    categories: categories.map(c => c.label)\n  }, null);\n  articles.forEach(article => {\n    feed.item({\n      title: article.title,\n      description: article.html || article.content,\n      url: url.resolve(setting.systemUrl, 'article/' + article.id),\n      date: article.publishAt,\n      categories: [(article.category || {}).label]\n    });\n  }); // @ts-ignore\n\n  res.write(feed.xml());\n  res.end();\n};\n\nexport default Rss;","map":null,"metadata":{},"sourceType":"module"}