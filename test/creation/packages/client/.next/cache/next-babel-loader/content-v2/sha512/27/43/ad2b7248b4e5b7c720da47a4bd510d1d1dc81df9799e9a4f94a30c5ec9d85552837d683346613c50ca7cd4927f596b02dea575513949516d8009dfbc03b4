{"ast":null,"code":"import _defineProperty from \"/Users/zsj/work/vimconfig/test/creation/packages/client/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _slicedToArray from \"/Users/zsj/work/vimconfig/test/creation/packages/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar __jsx = React.createElement;\nimport React, { useEffect } from 'react';\nimport cls from 'classnames';\nimport Link from 'next/link';\nimport { useTranslations } from 'next-intl';\nimport { default as Router, useRouter } from 'next/router';\nimport { SearchOutlined } from '@ant-design/icons';\nimport { getDocumentScrollTop } from '@/utils';\nimport { useToggle } from '@/hooks/useToggle';\nimport { Search } from '@/components/Search';\nimport { Theme } from '@/components/Theme';\nimport { Locales } from '@/components/Locales';\nimport style from './index.module.scss';\nvar NAV_LINKS = [{\n  path: '/',\n  locale: 'article'\n}, {\n  path: '/archives',\n  locale: 'archives'\n}, {\n  path: '/knowledge',\n  locale: 'knowledgeBooks'\n}];\nexport var Header = function Header(_ref) {\n  var setting = _ref.setting,\n      tags = _ref.tags,\n      pages = _ref.pages;\n  var t = useTranslations();\n  var router = useRouter();\n  var asPath = router.asPath;\n\n  var _useToggle = useToggle(false),\n      _useToggle2 = _slicedToArray(_useToggle, 2),\n      affix = _useToggle2[0],\n      setAffix = _useToggle2[1];\n\n  var _useToggle3 = useToggle(false),\n      _useToggle4 = _slicedToArray(_useToggle3, 2),\n      affixVisible = _useToggle4[0],\n      setAffixVisible = _useToggle4[1];\n\n  var _useToggle5 = useToggle(false),\n      _useToggle6 = _slicedToArray(_useToggle5, 2),\n      visible = _useToggle6[0],\n      setVisible = _useToggle6[1];\n\n  var _useToggle7 = useToggle(false),\n      _useToggle8 = _slicedToArray(_useToggle7, 2),\n      showSearch = _useToggle8[0],\n      toggleSearch = _useToggle8[1];\n\n  useEffect(function () {\n    var close = function close() {\n      if (visible) {\n        setVisible(false);\n      }\n    };\n\n    Router.events.on('routeChangeStart', close);\n    return function () {\n      Router.events.off('routeChangeStart', close);\n    };\n  }, [setVisible, visible]);\n  useEffect(function () {\n    var beforeY = 0;\n    var y = 0;\n\n    var handler = function handler() {\n      y = getDocumentScrollTop();\n      setAffix(y > 0);\n      setAffixVisible(beforeY >= y);\n      setTimeout(function () {\n        beforeY = y;\n      }, 0);\n    };\n\n    document.addEventListener('scroll', handler);\n    return function () {\n      document.removeEventListener('scroll', handler);\n    };\n  }, [setAffix, setAffixVisible]);\n  var navMenu = NAV_LINKS.map(function (nav) {\n    return __jsx(\"li\", {\n      key: nav.path,\n      className: cls(_defineProperty({}, style.active, asPath === nav.path))\n    }, __jsx(Link, {\n      href: nav.path\n    }, __jsx(\"a\", null, __jsx(\"span\", null, t(nav.locale)))));\n  });\n  var pageMenu = pages.map(function (menu) {\n    return __jsx(\"li\", {\n      key: menu.label,\n      className: cls(_defineProperty({}, style.active, asPath.replace('/page/', '') === menu.path)),\n      onClick: function onClick() {\n        if (visible) {\n          setVisible(false);\n        }\n      }\n    }, __jsx(Link, {\n      href: '/page/[id]',\n      as: \"/page/\".concat(menu.path),\n      scroll: false\n    }, __jsx(\"a\", null, menu.name)));\n  });\n  return __jsx(\"header\", {\n    className: cls(style.header)\n  }, __jsx(\"div\", {\n    className: cls(style.wrapper, affix ? style.isFixed : false, affixVisible ? style.visible : false)\n  }, __jsx(\"div\", {\n    className: cls('container')\n  }, __jsx(\"div\", {\n    className: style.logo\n  }, /^http/.test(setting.systemLogo) ? __jsx(Link, {\n    href: \"/\",\n    scroll: false\n  }, __jsx(\"a\", null, __jsx(\"img\", {\n    src: setting.systemLogo,\n    alt: \"\"\n  }))) : __jsx(Link, {\n    href: \"/\",\n    scroll: false\n  }, __jsx(\"a\", {\n    dangerouslySetInnerHTML: {\n      __html: setting.systemLogo\n    }\n  }))), __jsx(\"div\", {\n    className: cls(style.mobileTrigger, visible ? style.active : false),\n    onClick: function onClick() {\n      return setVisible(!visible);\n    }\n  }, __jsx(\"div\", {\n    className: style.stick\n  }), __jsx(\"div\", {\n    className: style.stick\n  }), __jsx(\"div\", {\n    className: style.stick\n  })), __jsx(\"nav\", {\n    className: cls(visible ? style.active : false)\n  }, __jsx(\"ul\", null, navMenu, pageMenu, __jsx(\"li\", {\n    className: style.toolWrapper\n  }, __jsx(SearchOutlined, {\n    style: {\n      cursor: 'pointer'\n    },\n    onClick: toggleSearch\n  })), __jsx(\"li\", {\n    className: style.toolWrapper\n  }, __jsx(Theme, null)), __jsx(\"li\", {\n    className: style.toolWrapper\n  }, __jsx(Locales, null))), __jsx(Search, {\n    tags: tags,\n    visible: showSearch,\n    onClose: toggleSearch\n  })))));\n};","map":null,"metadata":{},"sourceType":"module"}