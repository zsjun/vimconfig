{"ast":null,"code":"import \"antd/lib/badge/style\";\nimport _Badge from \"antd/lib/badge\";\nimport _toConsumableArray from \"/Users/zsj/work/vimconfig/test/creation/packages/client/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nvar __jsx = React.createElement;\nimport React, { useCallback, useEffect, useState } from 'react';\nimport cls from 'classnames';\nimport style from './index.module.scss';\nexport var Likes = function Likes(_ref) {\n  var defaultCount = _ref.defaultCount,\n      id = _ref.id,\n      api = _ref.api;\n\n  var _useState = useState(defaultCount),\n      count = _useState[0],\n      setCount = _useState[1];\n\n  var _useState2 = useState([]),\n      likes = _useState2[0],\n      setLikes = _useState2[1];\n\n  var like = useCallback(function () {\n    var idx = likes.indexOf(id);\n    var type = idx > -1 ? 'dislike' : 'like';\n    var newLikes = idx > -1 ? [].concat(_toConsumableArray(likes.slice(0, idx)), _toConsumableArray(likes.slice(idx + 1))) : [].concat(_toConsumableArray(likes), [id]);\n    api(id, type).then(function (c) {\n      setCount(c);\n      window.localStorage.setItem('LIKES', JSON.stringify(newLikes));\n      setLikes(newLikes);\n    });\n  }, [likes, id, api]);\n  useEffect(function () {\n    setCount(defaultCount);\n  }, [defaultCount]);\n  useEffect(function () {\n    var likeds = JSON.parse(window.localStorage.getItem('LIKES')) || [];\n    setLikes(likeds);\n  }, []);\n  return __jsx(_Badge, {\n    size: \"small\",\n    count: count,\n    style: {\n      backgroundColor: 'var(--primary-color)'\n    }\n  }, __jsx(\"div\", {\n    className: cls(style.wrap, likes.includes(id) && style.active),\n    onClick: like\n  }, __jsx(\"svg\", {\n    viewBox: \"0 0 1024 1024\",\n    version: \"1.1\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: \"1em\",\n    height: \"1em\"\n  }, __jsx(\"path\", {\n    d: \"M859.8 191.2c-80.8-84.2-212-84.2-292.8 0L512 248.2l-55-57.2c-81-84.2-212-84.2-292.8 0-91 94.6-91 248.2 0 342.8L512 896l347.8-362C950.8 439.4 950.8 285.8 859.8 191.2z\",\n    fill: \"currentColor\"\n  }))));\n};","map":null,"metadata":{},"sourceType":"module"}