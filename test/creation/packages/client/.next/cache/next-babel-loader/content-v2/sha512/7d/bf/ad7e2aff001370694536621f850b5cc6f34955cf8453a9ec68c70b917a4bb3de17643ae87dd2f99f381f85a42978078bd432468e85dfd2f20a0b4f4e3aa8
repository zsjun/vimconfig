{"ast":null,"code":"import _regeneratorRuntime from \"/Users/zsj/work/vimconfig/test/creation/packages/client/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/zsj/work/vimconfig/test/creation/packages/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nvar __jsx = React.createElement;\nimport React, { useContext } from 'react';\nimport Link from 'next/link';\nimport { useTranslations } from 'next-intl';\nimport { ArticleProvider } from '@/providers/article';\nimport { GlobalContext } from '@/context/global';\nimport { DoubleColumnLayout } from '@/layout/DoubleColumnLayout';\nimport { ListTrail } from '@/components/Animation/Trail';\nimport { LocaleTime } from '@/components/LocaleTime';\nimport { ArticleRecommend } from '@/components/ArticleRecommend';\nimport { Categories } from '@components/Categories';\nimport style from './index.module.scss';\n\nvar ArchiveItem = function ArchiveItem(_ref) {\n  var month = _ref.month,\n      _ref$articles = _ref.articles,\n      articles = _ref$articles === void 0 ? [] : _ref$articles;\n  return __jsx(\"div\", {\n    className: style.item\n  }, __jsx(\"h3\", null, month), __jsx(\"ul\", null, __jsx(ListTrail, {\n    length: articles.length,\n    options: {\n      opacity: 1,\n      height: 48,\n      x: 0,\n      from: {\n        opacity: 0,\n        height: 0,\n        x: -20\n      }\n    },\n    renderItem: function renderItem(index) {\n      var article = articles[index];\n      return __jsx(Link, {\n        href: \"/article/[id]\",\n        as: \"/article/\".concat(article.id),\n        scroll: false\n      }, __jsx(\"a\", null, __jsx(\"span\", {\n        className: style.meta\n      }, __jsx(LocaleTime, {\n        date: article.publishAt,\n        format: 'MM-dd'\n      })), __jsx(\"span\", {\n        className: style.title\n      }, article.title)));\n    }\n  })));\n};\n\nvar resolveArticlesCount = function resolveArticlesCount(articles) {\n  var years = Object.keys(articles);\n  return years.reduce(function (a, year) {\n    var months = Object.keys(articles[year]);\n    a += months.reduce(function (b, month) {\n      return b += articles[year][month].length;\n    }, 0);\n    return a;\n  }, 0);\n};\n\nvar Archives = function Archives(_ref2) {\n  var articles = _ref2.articles;\n\n  var _useContext = useContext(GlobalContext),\n      categories = _useContext.categories;\n\n  var t = useTranslations();\n  return __jsx(DoubleColumnLayout, {\n    leftNode: __jsx(\"div\", {\n      className: style.content\n    }, __jsx(\"div\", {\n      className: style.summary\n    }, __jsx(\"p\", null, __jsx(\"span\", null, t('archives'))), __jsx(\"p\", null, t('total'), \" \", __jsx(\"span\", null, resolveArticlesCount(articles)), \" \", t('piece'))), Object.keys(articles).sort(function (a, b) {\n      return +b - +a;\n    }).map(function (year) {\n      return __jsx(\"div\", {\n        className: style.list,\n        key: year\n      }, __jsx(\"h2\", null, year), Object.keys(articles[year]).map(function (month) {\n        return __jsx(ArchiveItem, {\n          key: year + '-' + month,\n          month: month,\n          articles: articles[year][month]\n        });\n      }));\n    })),\n    rightNode: __jsx(\"div\", {\n      className: \"sticky\"\n    }, __jsx(ArticleRecommend, {\n      mode: \"inline\"\n    }), __jsx(Categories, {\n      categories: categories\n    }))\n  });\n}; // 服务端预取数据\n\n\nArchives.getInitialProps = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n  var articles;\n  return _regeneratorRuntime.wrap(function _callee$(_context) {\n    while (1) {\n      switch (_context.prev = _context.next) {\n        case 0:\n          _context.next = 2;\n          return ArticleProvider.getArchives();\n\n        case 2:\n          articles = _context.sent;\n          return _context.abrupt(\"return\", {\n            articles: articles\n          });\n\n        case 4:\n        case \"end\":\n          return _context.stop();\n      }\n    }\n  }, _callee);\n}));\nexport default Archives;","map":null,"metadata":{},"sourceType":"module"}